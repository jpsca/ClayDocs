{#def toc #}

{% set max_depth = 3 %}
{% set margins = ["ml-0", "ml-4", "ml-8", "ml-12"] %}

{% macro render_item(url, title, depth=0) %}
<li class="{{ margins[depth] }}">
  <a href="{{ url }}"
    class="
      flex items-center
      py-1 leading-snug
      text-zinc-600 hover:text-black hover:font-medium
      dark:text-zinc-500 dark:hover:text-zinc-100
      [&.active]:text-accent [&.active]:dark:text-accent-darker
    "
  >
    {{ title }}
  </a>
</li>
{% endmacro %}

{% macro render_sub_items(pages, depth=0) %}
{%- for url, title, children in pages %}
  {{ render_item(url, title, depth) }}
  {% if depth < max_depth -%}
    {{ render_sub_items(children, depth) }}
  {%- endif %}
{%- endfor %}
{% endmacro %}

<ul {{ attrs.render() }}>
{%- for url, title, children in toc %}
  {{ render_item(url, title) }}
  {{ render_sub_items(children, depth=1) }}
{%- endfor %}
</ul>
