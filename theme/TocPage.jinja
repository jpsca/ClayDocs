{#def toc #}

{% set max_depth = 3 %}
{% set indent = ["pl-2", "pl-4", "pl-8", "pl-12"] %}

{% macro render_item(url, title, depth=0) %}
<li>
  <a href="{{ url }}"
    class="
      flex items-center
      py-1 px-2 leading-snug
      text-zinc-600 hover:text-black border-l border-transparent hover:border-zinc-400
      dark:text-zinc-500 dark:hover:text-zinc-100
      [&.active]:text-accent [&.active]:dark:text-accent-darker
      {{ indent[depth] }}
    "
  >
    {{ title }}
  </a>
</li>
{% endmacro %}

{% macro render_sub_items(pages, depth=0) %}
{%- for url, title, children in pages %}
  {{ render_item(url, title, depth) }}
  {% if depth < max_depth -%}
    {{ render_sub_items(children, depth) }}
  {%- endif %}
{%- endfor %}
{% endmacro %}

<ul {{ attrs.render() }}>
{%- for url, title, children in toc %}
  {{ render_item(url, title) }}
  {{ render_sub_items(children, depth=1) }}
{%- endfor %}
</ul>
