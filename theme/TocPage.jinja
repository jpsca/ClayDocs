{#def toc #}

{% set max_depth = 3 %}
{% set indent = ["ml-0", "ml-2", "ml-4", "ml-8"] %}

{% macro render_item(url, title, depth=0) %}
<li>
  <a href="{{ url }}"
    class="
      flex items-center
      py-1 pl-3 pr-2 leading-snug
      text-zinc-600 dark:text-zinc-500
      hover:text-black dark:hover:text-zinc-100
      border-l border-zinc-100 dark:border-zinc-700/50
      hover:border-zinc-300 dark:hover:border-zinc-400
      [&.active]:text-accent [&.active]:dark:text-accent-darker
      {{ indent[depth] }}
    "
  >
    {{ title }}
  </a>
</li>
{% endmacro %}

{% macro render_sub_items(pages, depth=0) %}
{%- for url, title, children in pages %}
  {{ render_item(url, title, depth) }}
  {% if depth < max_depth -%}
    {{ render_sub_items(children, depth) }}
  {%- endif %}
{%- endfor %}
{% endmacro %}

<ul {{ attrs.render() }}>
{%- for url, title, children in toc %}
  {{ render_item(url, title) }}
  {{ render_sub_items(children, depth=1) }}
{%- endfor %}
</ul>
